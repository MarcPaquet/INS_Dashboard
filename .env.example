# INS Dashboard - Environment Configuration Template
# Copy this file to .env and fill in your actual values
# NEVER commit .env files with real credentials to version control

# ============================================================================
# SUPABASE DATABASE CONFIGURATION (Required)
# ============================================================================

# Your Supabase project URL
# Format: https://your-project-id.supabase.co
SUPABASE_URL=https://your-project-id.supabase.co

# Supabase Service Role Key (for backend operations)
# This key has full database access - keep it secure!
# Find in: Supabase Dashboard > Settings > API > Service Role Key
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here

# Optional: Supabase Anonymous Key (for read-only dashboard access)
# Find in: Supabase Dashboard > Settings > API > Anonymous Key
# SUPABASE_ANON_KEY=your_anon_key_here

# ============================================================================
# INTERVALS.ICU API CONFIGURATION
# ============================================================================

# NOTE: Intervals.icu API keys are stored per-athlete in athletes.json
# No global API key needed in environment variables

# Intervals.icu API Base URL (usually doesn't need to change)
INTERVALS_API_URL=https://intervals.icu/api/v1

# ============================================================================
# WEATHER API CONFIGURATION (Optional)
# ============================================================================

# Open-Meteo API Configuration (Free tier, no key required)
OPENMETEO_API_URL=https://api.open-meteo.com

# API Timeouts (seconds)
OM_TIMEOUT=10                    # Open-Meteo weather timeout
AQ_TIMEOUT=10                    # Air quality API timeout
ELEV_TIMEOUT=8                   # Elevation API timeout

# ============================================================================
# DASHBOARD CONFIGURATION
# ============================================================================

# Dashboard host and port
DASHBOARD_HOST=127.0.0.1
DASHBOARD_PORT=8000

# Dashboard debug mode (set to False in production)
DASHBOARD_DEBUG=True

# ============================================================================
# DATA INGESTION CONFIGURATION
# ============================================================================

# Batch size for database operations
BATCH_SIZE=500

# Retry configuration
MAX_RETRIES=3
RETRY_DELAY=2

# Import date limits (optional)
# DEFAULT_OLDEST_DATE=2024-01-01
# DEFAULT_NEWEST_DATE=2025-12-31

# ============================================================================
# LOGGING CONFIGURATION
# ============================================================================

# Log level (DEBUG, INFO, WARNING, ERROR, CRITICAL)
LOG_LEVEL=INFO

# Log file path (optional, logs to console if not set)
# LOG_FILE=logs/ins_dashboard.log

# Enable colored logging output
LOG_COLORS=True

# ============================================================================
# DEVELOPMENT CONFIGURATION (Optional)
# ============================================================================

# Development mode settings
DEV_MODE=False

# Test database configuration (for development/testing)
# TEST_SUPABASE_URL=https://your-test-project.supabase.co
# TEST_SUPABASE_KEY=your_test_service_role_key

# ============================================================================
# SECURITY NOTES
# ============================================================================

# ðŸ”’ SECURITY REMINDERS:
# 
# 1. NEVER commit .env files to version control
# 2. Use different keys for development/production
# 3. Rotate API keys regularly
# 4. Limit database permissions where possible
# 5. Use HTTPS in production
# 
# ðŸš¨ IF KEYS ARE COMPROMISED:
# 1. Immediately rotate all API keys
# 2. Check Supabase logs for unauthorized access
# 3. Review database permissions
# 4. Update all deployment environments

# ============================================================================
# EXAMPLE ATHLETES.JSON STRUCTURE
# ============================================================================

# Create athletes.json with this structure:
# [
#   {
#     "id": "i344978",
#     "name": "Athlete Name",
#     "api_key": "intervals_icu_api_key_here"
#   }
# ]
#
# Generate template with: python scripts/setup_athletes.py

# ============================================================================
# DEPLOYMENT ENVIRONMENTS
# ============================================================================

# For different environments, create separate .env files:
# - .env.development
# - .env.staging  
# - .env.production
#
# Load specific environment with:
# python -m dotenv -f .env.production run python src/dashboard/app.py

# ============================================================================
# TROUBLESHOOTING
# ============================================================================

# Common issues and solutions:
#
# 1. "Missing SUPABASE_URL" error:
#    - Verify .env file exists and is in correct directory
#    - Check variable names match exactly (case-sensitive)
#
# 2. "Invalid API key" error:
#    - Verify Supabase keys are correct and not expired
#    - Check project permissions in Supabase dashboard
#
# 3. "Connection timeout" error:
#    - Increase timeout values above
#    - Check network connectivity
#
# 4. Dashboard not accessible:
#    - Verify DASHBOARD_HOST and DASHBOARD_PORT settings
#    - Check if port is already in use

# ============================================================================
# VALIDATION COMMANDS
# ============================================================================

# Test your configuration with:
# python scripts/check_database_schema.py      # Test database connection
# python scripts/check_import_progress.py      # Test API connectivity
# python src/dashboard/app.py                  # Test dashboard startup
